(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{6254:function(e,t,o){Promise.resolve().then(o.bind(o,1242))},1242:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return s}});var a=o(7821),r=o(8078),i=o(6179),l=o(4417);function s(){let e=(0,i.useRouter)(),[t,o]=(0,r.useState)(!1),[s,n]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)([]),[g,x]=(0,r.useState)([]),[h,p]=(0,r.useState)({title:"",content:"",excerpt:"",editor_content:"",status:"draft",political_bias:"",location:""});(0,r.useEffect)(()=>{b()},[]);let b=async()=>{try{let e=await l.Z.get("/tags");m(e.data)}catch(e){console.error("Error fetching tags:",e)}},f=async e=>{var t;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){n(!0);try{let e=new FormData;e.append("image",o);let t=localStorage.getItem("token"),a=await fetch("".concat("http://localhost:3001","/api/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e});if(!a.ok)throw Error("Error al subir la imagen");let r=await a.json();d(r.filePath)}catch(e){console.error("Error uploading image:",e),alert("Error al subir la imagen")}finally{n(!1)}}},y=async t=>{t.preventDefault(),o(!0);try{let t={title:h.title,content:h.content,status:h.status};h.editor_content&&(t.editor_content=h.editor_content),c&&(t.cover_image=c),h.political_bias&&(t.political_bias=h.political_bias),h.location&&(t.location=h.location),g.length>0&&(t.tag_ids=g);let o=await l.Z.post("/articles",t);e.push("/admin/articles/".concat(o.data.id,"/edit"))}catch(e){var a,r;console.error("Error creating article:",e),alert((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Error al crear la noticia")}finally{o(!1)}};return(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Nueva Noticia"}),(0,a.jsx)("form",{onSubmit:y,className:"bg-white shadow rounded-lg p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"T\xedtulo *"}),(0,a.jsx)("input",{type:"text",id:"title",required:!0,value:h.title,onChange:e=>p({...h,title:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"excerpt",className:"block text-sm font-medium text-gray-700",children:"Subt\xedtulo / Breve Descripci\xf3n"}),(0,a.jsx)("textarea",{id:"excerpt",rows:3,value:h.excerpt,onChange:e=>p({...h,excerpt:e.target.value}),placeholder:"Breve descripci\xf3n que aparecer\xe1 en la p\xe1gina principal (opcional)",maxLength:500,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"}),(0,a.jsxs)("p",{className:"mt-1 text-xs text-gray-500",children:[h.excerpt.length,"/500 caracteres"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Contenido *"}),(0,a.jsx)("textarea",{id:"content",required:!0,rows:10,value:h.content,onChange:e=>p({...h,content:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"cover_image",className:"block text-sm font-medium text-gray-700",children:"Foto de Portada"}),(0,a.jsx)("input",{type:"file",id:"cover_image",accept:"image/*",onChange:f,disabled:s,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"}),s&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Subiendo imagen..."}),c&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("img",{src:"".concat("http://localhost:3001").concat(c),alt:"Vista previa",className:"max-w-md h-48 object-cover rounded-lg border border-gray-300"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"editor_content",className:"block text-sm font-medium text-gray-700",children:"Redacci\xf3n Editorial"}),(0,a.jsx)("textarea",{id:"editor_content",rows:6,value:h.editor_content,onChange:e=>p({...h,editor_content:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"An\xe1lisis o redacci\xf3n propia del editor..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,a.jsxs)("select",{id:"status",value:h.status,onChange:e=>p({...h,status:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"draft",children:"Borrador"}),(0,a.jsx)("option",{value:"published",children:"Publicada"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"political_bias",className:"block text-sm font-medium text-gray-700",children:"Sesgo Pol\xedtico"}),(0,a.jsxs)("select",{id:"political_bias",value:h.political_bias,onChange:e=>p({...h,political_bias:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"Sin clasificar"}),(0,a.jsx)("option",{value:"left",children:"Izquierda"}),(0,a.jsx)("option",{value:"center",children:"Centro"}),(0,a.jsx)("option",{value:"right",children:"Derecha"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700",children:"Ubicaci\xf3n (Ciudad o Provincia)"}),(0,a.jsx)("input",{type:"text",id:"location",value:h.location,onChange:e=>p({...h,location:e.target.value}),placeholder:"Ej: Buenos Aires, C\xf3rdoba, etc.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags / Categor\xedas"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:u.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 p-2 border border-gray-300 rounded-md hover:bg-gray-50 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:t=>{t.target.checked?x([...g,e.id]):x(g.filter(t=>t!==e.id))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:t,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:t?"Guardando...":"Guardar"})]})]})})]})}},4417:function(e,t,o){"use strict";let a=o(1892).Z.create({baseURL:"".concat("http://localhost:3001","/api"),headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/admin/login"),Promise.reject(e)}),t.Z=a},6179:function(e,t,o){e.exports=o(319)}},function(e){e.O(0,[885,115,141,744],function(){return e(e.s=6254)}),_N_E=e.O()}]);