(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{6216:function(e,t,r){Promise.resolve().then(r.bind(r,2456))},2456:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7821),n=r(6179),s=r(4077),i=r(8078),o=r(6871),l=r.n(o);function c(e){let{children:t}=e,r=(0,n.useRouter)(),o=(0,n.usePathname)(),[c,d]=(0,i.useState)(s.O.getUser());return(0,i.useEffect)(()=>{"/admin/login"===o||s.O.isAuthenticated()||r.push("/admin/login")},[r,o]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Panel de Administraci\xf3n"})}),(0,a.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,a.jsx)(l(),{href:"/admin",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/admin"===o?"border-indigo-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,a.jsx)(l(),{href:"/admin/articles",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat((null==o?void 0:o.startsWith("/admin/articles"))?"border-indigo-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Noticias"}),(0,a.jsx)(l(),{href:"/admin/media-sources",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat((null==o?void 0:o.startsWith("/admin/media-sources"))?"border-indigo-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Medios"})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700 mr-4",children:null==c?void 0:c.email}),(0,a.jsx)("button",{onClick:()=>{s.O.logout(),r.push("/admin/login")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Cerrar Sesi\xf3n"})]})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:t})]})}function d(e){let{children:t}=e,r=(0,n.useRouter)(),[o,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{(async()=>{if(!s.O.isAuthenticated()){r.push("/admin/login"),l(!1);return}try{await s.O.getCurrentUser(),d(!0)}catch(e){s.O.logout(),r.push("/admin/login")}finally{l(!1)}})()},[r]),o)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando..."})]})}):c?(0,a.jsx)(a.Fragment,{children:t}):null}function m(e){let{children:t}=e;return"/admin/login"===(0,n.usePathname)()?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(d,{children:(0,a.jsx)(c,{children:t})})}},4417:function(e,t,r){"use strict";let a=r(1892).Z.create({baseURL:"".concat("http://localhost:3001","/api"),headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/admin/login"),Promise.reject(e)}),t.Z=a},4077:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var a=r(4417);let n={async login(e,t){let r=await a.Z.post("/auth/login",{email:e,password:t});return r.data.token&&(localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user))),r.data},async register(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"editor",n=await a.Z.post("/auth/register",{email:e,password:t,role:r});return n.data.token&&(localStorage.setItem("token",n.data.token),localStorage.setItem("user",JSON.stringify(n.data.user))),n.data},getCurrentUser:async()=>(await a.Z.get("/auth/me")).data.user,logout(){localStorage.removeItem("token"),localStorage.removeItem("user")},getToken:()=>localStorage.getItem("token"),getUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){return null!==this.getToken()}}},6871:function(e,t,r){e.exports=r(1844)},6179:function(e,t,r){e.exports=r(319)}},function(e){e.O(0,[885,844,115,141,744],function(){return e(e.s=6216)}),_N_E=e.O()}]);